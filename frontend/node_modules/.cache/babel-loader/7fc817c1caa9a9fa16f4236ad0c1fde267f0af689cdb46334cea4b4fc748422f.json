{"ast":null,"code":"var _jsxFileName = \"/Users/trygverefvem/kioversikt/frontend/src/components/ExcelImport.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { importInitiativerFromExcel } from '../services/initiativService';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ExcelImport = ({\n  onImportSuccess\n}) => {\n  _s();\n  const [file, setFile] = useState(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [error, setError] = useState(null);\n  const [success, setSuccess] = useState(null);\n  const handleFileChange = e => {\n    if (e.target.files && e.target.files.length > 0) {\n      setFile(e.target.files[0]);\n      setError(null);\n      setSuccess(null);\n    }\n  };\n  const handleSubmit = async e => {\n    var _file$name$split$pop;\n    e.preventDefault();\n    if (!file) {\n      setError('Vennligst velg en Excel-fil først');\n      return;\n    }\n\n    // Sjekk filtype\n    const fileType = (_file$name$split$pop = file.name.split('.').pop()) === null || _file$name$split$pop === void 0 ? void 0 : _file$name$split$pop.toLowerCase();\n    if (fileType !== 'xls' && fileType !== 'xlsx') {\n      setError('Kun Excel-filer (.xls, .xlsx) er tillatt');\n      return;\n    }\n    try {\n      setIsUploading(true);\n      setError(null);\n      const result = await importInitiativerFromExcel(file);\n      setSuccess(`${result.opprettede.length} initiativer ble importert. ${result.feilet.length} feilet.`);\n      setFile(null);\n\n      // Nullstill filinput\n      const fileInput = document.getElementById('excel-file');\n      if (fileInput) {\n        fileInput.value = '';\n      }\n\n      // Informer parent-komponenten om vellykket import\n      onImportSuccess();\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Kunne ikke importere Excel-filen. Vennligst prøv igjen.');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white p-6 rounded-lg shadow-md mb-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl font-semibold mb-4\",\n      children: \"Importer initiativer fra Excel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"excel-file\",\n          className: \"block text-sm font-medium text-gray-700 mb-2\",\n          children: \"Velg Excel-fil\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          id: \"excel-file\",\n          accept: \".xls,.xlsx\",\n          onChange: handleFileChange,\n          className: \"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-1 text-sm text-gray-500\",\n          children: \"Filen vil bli analysert med AI for \\xE5 strukturere dataene\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 p-3 bg-red-50 text-red-700 rounded-md\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4 p-3 bg-green-50 text-green-700 rounded-md\",\n        children: success\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !file || isUploading,\n        className: `btn ${!file || isUploading ? 'btn-disabled' : 'btn-primary'}`,\n        children: isUploading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"inline-block animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this), \"Importerer...\"]\n        }, void 0, true) : 'Importer initiativer'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n};\n_s(ExcelImport, \"mhO5kWd15ZU1FeiSVQLspMJSSk4=\");\n_c = ExcelImport;\nexport default ExcelImport;\nvar _c;\n$RefreshReg$(_c, \"ExcelImport\");","map":{"version":3,"names":["React","useState","importInitiativerFromExcel","jsxDEV","_jsxDEV","Fragment","_Fragment","ExcelImport","onImportSuccess","_s","file","setFile","isUploading","setIsUploading","error","setError","success","setSuccess","handleFileChange","e","target","files","length","handleSubmit","_file$name$split$pop","preventDefault","fileType","name","split","pop","toLowerCase","result","opprettede","feilet","fileInput","document","getElementById","value","err","_err$response","_err$response$data","response","data","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","type","id","accept","onChange","disabled","_c","$RefreshReg$"],"sources":["/Users/trygverefvem/kioversikt/frontend/src/components/ExcelImport.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { importInitiativerFromExcel } from '../services/initiativService';\n\ninterface ExcelImportProps {\n  onImportSuccess: () => void;\n}\n\nconst ExcelImport: React.FC<ExcelImportProps> = ({ onImportSuccess }) => {\n  const [file, setFile] = useState<File | null>(null);\n  const [isUploading, setIsUploading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files.length > 0) {\n      setFile(e.target.files[0]);\n      setError(null);\n      setSuccess(null);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!file) {\n      setError('Vennligst velg en Excel-fil først');\n      return;\n    }\n    \n    // Sjekk filtype\n    const fileType = file.name.split('.').pop()?.toLowerCase();\n    if (fileType !== 'xls' && fileType !== 'xlsx') {\n      setError('Kun Excel-filer (.xls, .xlsx) er tillatt');\n      return;\n    }\n    \n    try {\n      setIsUploading(true);\n      setError(null);\n      \n      const result = await importInitiativerFromExcel(file);\n      \n      setSuccess(`${result.opprettede.length} initiativer ble importert. ${result.feilet.length} feilet.`);\n      setFile(null);\n      \n      // Nullstill filinput\n      const fileInput = document.getElementById('excel-file') as HTMLInputElement;\n      if (fileInput) {\n        fileInput.value = '';\n      }\n      \n      // Informer parent-komponenten om vellykket import\n      onImportSuccess();\n    } catch (err: any) {\n      setError(err.response?.data?.message || 'Kunne ikke importere Excel-filen. Vennligst prøv igjen.');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white p-6 rounded-lg shadow-md mb-6\">\n      <h2 className=\"text-xl font-semibold mb-4\">Importer initiativer fra Excel</h2>\n      \n      <form onSubmit={handleSubmit}>\n        <div className=\"mb-4\">\n          <label htmlFor=\"excel-file\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n            Velg Excel-fil\n          </label>\n          <input\n            type=\"file\"\n            id=\"excel-file\"\n            accept=\".xls,.xlsx\"\n            onChange={handleFileChange}\n            className=\"block w-full text-sm text-gray-500\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-md file:border-0\n                      file:text-sm file:font-semibold\n                      file:bg-primary-50 file:text-primary-700\n                      hover:file:bg-primary-100\"\n          />\n          <p className=\"mt-1 text-sm text-gray-500\">\n            Filen vil bli analysert med AI for å strukturere dataene\n          </p>\n        </div>\n        \n        {error && (\n          <div className=\"mb-4 p-3 bg-red-50 text-red-700 rounded-md\">\n            {error}\n          </div>\n        )}\n        \n        {success && (\n          <div className=\"mb-4 p-3 bg-green-50 text-green-700 rounded-md\">\n            {success}\n          </div>\n        )}\n        \n        <button\n          type=\"submit\"\n          disabled={!file || isUploading}\n          className={`btn ${\n            !file || isUploading ? 'btn-disabled' : 'btn-primary'\n          }`}\n        >\n          {isUploading ? (\n            <>\n              <span className=\"inline-block animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2\"></span>\n              Importerer...\n            </>\n          ) : (\n            'Importer initiativer'\n          )}\n        </button>\n      </form>\n    </div>\n  );\n};\n\nexport default ExcelImport; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}